{% extends "layout.html" %}

{% block title %}
Match Result - SimCricketX
{% endblock %}

{% block extra_css %}
<style>
    .result-header {
        text-align: center;
        margin-bottom: 2rem;
        padding: 2rem;
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 12px;
    }

    .match-result-text {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--accent);
        margin-bottom: 0.5rem;
    }

    .match-meta {
        color: var(--fg-secondary);
        font-size: 0.9rem;
    }

    .scorecard-section {
        margin-bottom: 2rem;
    }

    .innings-subtitle {
        margin-top: 0.5rem;
        font-size: 0.95rem;
        color: var(--fg-secondary);
    }

    .section-title {
        margin: 1rem 0 0.5rem;
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--fg-secondary);
        text-transform: uppercase;
        letter-spacing: 0.04em;
    }

    .innings-header {
        background: var(--bg-secondary);
        padding: 0.75rem 1rem;
        border-radius: 8px 8px 0 0;
        font-weight: 600;
        border: 1px solid var(--card-border);
        display: flex;
        justify-content: space-between;
    }

    .score-table {
        width: 100%;
        border-collapse: collapse;
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-top: none;
    }

    .score-table th,
    .score-table td {
        padding: 0.75rem 1rem;
        text-align: left;
        border-bottom: 1px solid var(--card-border);
    }

    .score-table th {
        color: var(--fg-secondary);
        font-weight: 600;
        font-size: 0.85rem;
        text-transform: uppercase;
    }

    .score-table td {
        font-size: 0.9rem;
    }

    .batter-name {
        font-weight: 500;
        color: var(--fg);
    }

    .dismissal-info {
        font-size: 0.8rem;
        color: var(--fg-secondary);
    }

    .nav-actions {
        margin-top: 2rem;
        display: flex;
        gap: 1rem;
        justify-content: center;
    }
</style>
{% endblock %}

{% block content %}
<div class="result-header">
    <div class="match-result-text">{{ match.result_description or "Match Completed" }}</div>
    <div class="match-meta">
        {{ match.team_home }} vs {{ match.team_away }} • {{ match.venue }}
    </div>
</div>

<div class="container">
    {% for innings in innings_list %}
    <div class="scorecard-section">
        <div class="innings-header">
            <span>{{ innings.number }}{% if innings.number == 1 %}st{% elif innings.number == 2 %}nd{% else %}th{% endif %} Innings</span>
            <span>{{ innings.score }}/{{ innings.wickets }}</span>
        </div>
        <div class="innings-subtitle">{{ innings.batting_team_name }} batting • {{ innings.bowling_team_name }} bowling</div>

        <div class="section-title">Batting</div>
        <table class="score-table">
            <thead>
                <tr>
                    <th>Batter</th>
                    <th>Dismissal</th>
                    <th>R</th>
                    <th>B</th>
                    <th>4s</th>
                    <th>6s</th>
                </tr>
            </thead>
            <tbody>
                {% for batter in innings.batting %}
                <tr>
                    <td class="batter-name">{{ batter.name }}</td>
                    <td class="dismissal-info">
                        {% if batter.is_out %}
                        {% if batter.wicket_type == "Caught" %}
                        c {{ batter.fielder_name or "?" }} b {{ batter.wicket_taker_name or "?" }}
                        {% elif batter.wicket_type == "Bowled" %}
                        b {{ batter.wicket_taker_name or "?" }}
                        {% elif batter.wicket_type == "LBW" %}
                        lbw b {{ batter.wicket_taker_name or "?" }}
                        {% elif batter.wicket_type == "Run Out" %}
                        run out ({{ batter.fielder_name or "?" }})
                        {% elif batter.wicket_type == "Stumped" %}
                        st {{ batter.fielder_name or "?" }} b {{ batter.wicket_taker_name or "?" }}
                        {% elif batter.wicket_type == "Hit Wicket" %}
                        hit wicket b {{ batter.wicket_taker_name or "?" }}
                        {% else %}
                        {{ batter.wicket_type }}
                        {% if batter.wicket_taker_name %} b {{ batter.wicket_taker_name }}{% endif %}
                        {% endif %}
                        {% else %}
                        not out
                        {% endif %}
                    </td>
                    <td><b>{{ batter.runs }}</b></td>
                    <td>{{ batter.balls }}</td>
                    <td>{{ batter.fours }}</td>
                    <td>{{ batter.sixes }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6" style="text-align:center">No batting stats available</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="section-title">Bowling</div>
        <table class="score-table">
            <thead>
                <tr>
                    <th>Bowler</th>
                    <th>O</th>
                    <th>R</th>
                    <th>W</th>
                    <th>M</th>
                    <th>Wd</th>
                    <th>Nb</th>
                </tr>
            </thead>
            <tbody>
                {% for bowler in innings.bowling %}
                <tr>
                    <td class="batter-name">{{ bowler.name }}</td>
                    <td>{{ bowler.overs }}</td>
                    <td>{{ bowler.runs_conceded }}</td>
                    <td><b>{{ bowler.wickets }}</b></td>
                    <td>{{ bowler.maidens }}</td>
                    <td>{{ bowler.wides }}</td>
                    <td>{{ bowler.noballs }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" style="text-align:center">No bowling stats available</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endfor %}

    <div class="nav-actions">
        {% if match.tournament_id %}
        <a href="{{ url_for('tournament_dashboard', tournament_id=match.tournament_id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Tournament
        </a>
        {% else %}
        <a href="{{ url_for('home') }}" class="btn btn-secondary">
            <i class="fas fa-home"></i> Back Home
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}
