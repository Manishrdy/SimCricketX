<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Strategy Analyzer - Elite Performance Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">

    <style>
        :root {
            /* Light Theme */
            --bg: #f8f9fa;
            --bg-secondary: #e9ecef;
            --fg: #212529;
            --fg-secondary: #6c757d;
            --card-bg: #ffffff;
            --card-border: #dee2e6;
            --accent: #0d6efd;
            --accent-light: rgba(13, 110, 253, 0.1);
            --success: #198754;
            --danger: #dc3545;
        }

        [data-theme="dark"] {
            /* Dark Theme - VS Code One Dark Pro */
            --bg: #282c34;
            --bg-secondary: #21252b;
            --fg: #abb2bf;
            --fg-secondary: #5c6370;
            --card-bg: #21252b;
            --card-border: #3e4451;
            --accent: #61afef;
            --accent-light: rgba(97, 175, 239, 0.15);
            --success: #98c379;
            --danger: #e06c75;

            /* One Dark Pro Extended Palette */
            --one-dark-red: #e06c75;
            --one-dark-green: #98c379;
            --one-dark-yellow: #e5c07b;
            --one-dark-blue: #61afef;
            --one-dark-purple: #c678dd;
            --one-dark-cyan: #56b6c2;
            --one-dark-orange: #d19a66;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--fg);
            min-height: 100vh;
            transition: background 0.3s ease, color 0.3s ease;
        }

        [data-theme="dark"] body {
            background: linear-gradient(135deg, #282c34 0%, #21252b 50%, #282c34 100%);
        }

        .cricket-heading {
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
        }

        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
        }

        .pitch-card {
            background: var(--bg-secondary);
            transition: all 0.3s ease;
            border: 2px solid var(--card-border);
        }

        .pitch-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border-color: var(--accent);
        }

        .pitch-card.active {
            border-color: var(--one-dark-green, #98c379);
            background: rgba(152, 195, 121, 0.15);
            box-shadow: 0 0 20px rgba(152, 195, 121, 0.3);
        }

        .role-card {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
        }

        .role-card.active {
            background: var(--accent-light);
            border-color: var(--accent);
            box-shadow: 0 0 15px rgba(97, 175, 239, 0.3);
        }

        .performance-meter {
            background: linear-gradient(90deg, #dc2626 0%, #ea580c 25%, #eab308 50%, #22c55e 75%, #10b981 100%);
            height: 8px;
            border-radius: 4px;
        }

        .slider-container {
            position: relative;
        }

        .rating-slider {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, #dc2626 0%, #ea580c 25%, #eab308 50%, #22c55e 75%, #10b981 100%);
            outline: none;
            cursor: pointer;
        }

        .rating-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ffffff;
            border: 2px solid #10b981;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .rating-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ffffff;
            border: 2px solid #10b981;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .matchup-indicator {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: .7;
            }
        }

        .phase-tab {
            background: var(--bg-secondary);
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
            color: var(--fg);
        }

        .phase-tab.active {
            background: linear-gradient(145deg, var(--accent), var(--one-dark-purple, #c678dd));
            border-color: var(--accent);
            color: white;
        }

        .outcome-bar {
            transition: all 0.5s ease;
        }

        .rating-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
        }

        .rating-elite {
            background: linear-gradient(45deg, #dc2626, #ef4444);
            color: white;
        }

        .rating-excellent {
            background: linear-gradient(45deg, #ea580c, #f97316);
            color: white;
        }

        .rating-good {
            background: linear-gradient(45deg, #eab308, #facc15);
            color: black;
        }

        .rating-average {
            background: linear-gradient(45deg, #22c55e, #4ade80);
            color: white;
        }

        .rating-poor {
            background: linear-gradient(45deg, #6b7280, #9ca3af);
            color: white;
        }

        /* Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            font-size: 1.25rem;
            color: var(--fg);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Dark mode specific overrides */
        [data-theme="dark"] .bg-slate-800 { background-color: var(--bg-secondary) !important; }
        [data-theme="dark"] .text-slate-200 { color: var(--fg) !important; }
        [data-theme="dark"] .text-slate-300 { color: var(--fg) !important; }
        [data-theme="dark"] .text-slate-400 { color: var(--fg-secondary) !important; }
        [data-theme="dark"] .text-green-400 { color: var(--one-dark-green, #98c379) !important; }
        [data-theme="dark"] .text-red-400 { color: var(--one-dark-red, #e06c75) !important; }
        [data-theme="dark"] .text-blue-400 { color: var(--one-dark-blue, #61afef) !important; }
        [data-theme="dark"] .text-yellow-400 { color: var(--one-dark-yellow, #e5c07b) !important; }
        [data-theme="dark"] .text-purple-400 { color: var(--one-dark-purple, #c678dd) !important; }
        [data-theme="dark"] .border-slate-700 { border-color: var(--card-border) !important; }
        [data-theme="dark"] .border-slate-600 { border-color: var(--card-border) !important; }
    </style>
</head>

<body class="antialiased">
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="theme-toggle" title="Toggle Theme">
        <span id="theme-icon">‚òÄÔ∏è</span>
    </button>

    <div class="min-h-screen">
        <!-- Header -->
        <header class="glass-panel border-b border-slate-700">
            <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h1
                            class="cricket-heading text-4xl text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500">
                            üèè Elite Cricket Strategy Analyzer
                        </h1>
                        <p class="text-slate-400 mt-2 text-lg">Advanced Performance Prediction & Matchup Analysis</p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-slate-400">AI-Powered</div>
                        <div class="text-lg font-semibold text-green-400">Strategic Intelligence</div>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <!-- Game Phase Selector -->
            <div class="mb-8">
                <h2 class="cricket-heading text-2xl mb-4 text-slate-200">Match Phase Analysis</h2>
                <div class="flex gap-4 flex-wrap">
                    <button class="phase-tab px-6 py-3 rounded-lg font-semibold active" data-phase="powerplay">
                        ‚ö° Powerplay (1-6)
                    </button>
                    <button class="phase-tab px-6 py-3 rounded-lg font-semibold" data-phase="middle">
                        üéØ Middle Overs (7-16)
                    </button>
                    <button class="phase-tab px-6 py-3 rounded-lg font-semibold" data-phase="death">
                        üíÄ Death Overs (17-20)
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Left Panel: Player Controls -->
                <div class="lg:col-span-5 space-y-6">
                    <!-- Batsman Configuration -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-green-400">üèè Batsman Configuration</h3>

                        <!-- Batsman Role Selection -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-slate-300 mb-3">Player Role</label>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="role-card p-3 rounded-lg cursor-pointer active" data-role="batsman"
                                    data-type="batsman">
                                    <div class="font-semibold">Elite Batsman</div>
                                    <div class="text-xs text-slate-400">85-95 Rating</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-role="batting-ar"
                                    data-type="batsman">
                                    <div class="font-semibold">Batting AR</div>
                                    <div class="text-xs text-slate-400">80-88 Bat, 60-70 Bowl</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-role="genuine-ar"
                                    data-type="batsman">
                                    <div class="font-semibold">Genuine AR</div>
                                    <div class="text-xs text-slate-400">70-80 Both</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-role="bowling-ar"
                                    data-type="batsman">
                                    <div class="font-semibold">Bowling AR</div>
                                    <div class="text-xs text-slate-400">60-70 Bat, 80-88 Bowl</div>
                                </div>
                            </div>
                        </div>

                        <!-- Batsman Rating -->
                        <div class="mb-4">
                            <label class="flex justify-between items-center text-sm font-medium text-slate-300 mb-2">
                                <span>Batting Rating</span>
                                <div class="flex items-center gap-2">
                                    <span id="batsmanRatingValue" class="text-lg font-bold text-green-400">85</span>
                                    <span id="batsmanRatingBadge" class="rating-badge rating-excellent">Elite</span>
                                </div>
                            </label>
                            <div class="slider-container">
                                <input id="batsmanRating" type="range" min="40" max="95" value="85"
                                    class="rating-slider w-full">
                            </div>
                        </div>

                        <!-- Batting Hand -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-slate-300 mb-2">Batting Hand</label>
                            <div class="flex gap-3">
                                <button class="hand-btn px-4 py-2 rounded-lg border border-slate-600 active"
                                    data-hand="right" data-type="batsman">
                                    Right Hand
                                </button>
                                <button class="hand-btn px-4 py-2 rounded-lg border border-slate-600" data-hand="left"
                                    data-type="batsman">
                                    Left Hand
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Bowler Configuration -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-red-400">‚ö° Bowler Configuration</h3>

                        <!-- Bowling Type Selection -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-slate-300 mb-3">Bowling Type</label>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="role-card p-3 rounded-lg cursor-pointer active" data-bowling="Fast">
                                    <div class="font-semibold">Fast</div>
                                    <div class="text-xs text-slate-400">90-95 Elite</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-bowling="Fast-medium">
                                    <div class="font-semibold">Fast-Medium</div>
                                    <div class="text-xs text-slate-400">85-92 Elite</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-bowling="Medium-fast">
                                    <div class="font-semibold">Medium-Fast</div>
                                    <div class="text-xs text-slate-400">82-88 Elite</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-bowling="Off spin">
                                    <div class="font-semibold">Off Spin</div>
                                    <div class="text-xs text-slate-400">88-95 Elite</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-bowling="Leg spin">
                                    <div class="font-semibold">Leg Spin</div>
                                    <div class="text-xs text-slate-400">88-95 Elite</div>
                                </div>
                                <div class="role-card p-3 rounded-lg cursor-pointer" data-bowling="Finger spin">
                                    <div class="font-semibold">Finger Spin</div>
                                    <div class="text-xs text-slate-400">85-92 Elite</div>
                                </div>
                            </div>
                        </div>

                        <!-- Bowler Rating -->
                        <div class="mb-4">
                            <label class="flex justify-between items-center text-sm font-medium text-slate-300 mb-2">
                                <span>Bowling Rating</span>
                                <div class="flex items-center gap-2">
                                    <span id="bowlerRatingValue" class="text-lg font-bold text-red-400">85</span>
                                    <span id="bowlerRatingBadge" class="rating-badge rating-excellent">Elite</span>
                                </div>
                            </label>
                            <div class="slider-container">
                                <input id="bowlerRating" type="range" min="40" max="95" value="85"
                                    class="rating-slider w-full">
                            </div>
                        </div>

                        <!-- Bowling Hand -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-slate-300 mb-2">Bowling Hand</label>
                            <div class="flex gap-3">
                                <button class="hand-btn px-4 py-2 rounded-lg border border-slate-600 active"
                                    data-hand="right" data-type="bowler">
                                    Right Arm
                                </button>
                                <button class="hand-btn px-4 py-2 rounded-lg border border-slate-600" data-hand="left"
                                    data-type="bowler">
                                    Left Arm
                                </button>
                            </div>
                        </div>

                        <!-- Fielding Rating -->
                        <div class="mb-4">
                            <label class="flex justify-between items-center text-sm font-medium text-slate-300 mb-2">
                                <span>Fielding Rating</span>
                                <span id="fieldingRatingValue" class="text-lg font-bold text-yellow-400">80</span>
                            </label>
                            <div class="slider-container">
                                <input id="fieldingRating" type="range" min="45" max="95" value="80"
                                    class="rating-slider w-full">
                            </div>
                        </div>
                    </div>

                    <!-- Pitch Conditions -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-blue-400">üèüÔ∏è Pitch Analysis</h3>
                        <div class="grid grid-cols-1 gap-3">
                            <div class="pitch-card p-4 rounded-lg cursor-pointer active" data-pitch="Green">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-green-300">üå± Green Pitch</div>
                                        <div class="text-xs text-slate-400">Pace-friendly, 120-150 avg</div>
                                    </div>
                                    <div class="text-xs text-slate-400">Fast: +40% wickets</div>
                                </div>
                            </div>
                            <div class="pitch-card p-4 rounded-lg cursor-pointer" data-pitch="Dry">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-yellow-300">üèúÔ∏è Dry Pitch</div>
                                        <div class="text-xs text-slate-400">Spin-friendly, 120-150 avg</div>
                                    </div>
                                    <div class="text-xs text-slate-400">Spin: +40% wickets</div>
                                </div>
                            </div>
                            <div class="pitch-card p-4 rounded-lg cursor-pointer" data-pitch="Hard">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-gray-300">‚ö™ Hard Pitch</div>
                                        <div class="text-xs text-slate-400">Balanced, 150-180 avg</div>
                                    </div>
                                    <div class="text-xs text-slate-400">Even contest</div>
                                </div>
                            </div>
                            <div class="pitch-card p-4 rounded-lg cursor-pointer" data-pitch="Flat">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-blue-300">üõ£Ô∏è Flat Pitch</div>
                                        <div class="text-xs text-slate-400">Batting paradise, 180-200 avg</div>
                                    </div>
                                    <div class="text-xs text-slate-400">Bat dominance</div>
                                </div>
                            </div>
                            <div class="pitch-card p-4 rounded-lg cursor-pointer" data-pitch="Dead">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-purple-300">üíÄ Dead Pitch</div>
                                        <div class="text-xs text-slate-400">Batting festival, 200-240 avg</div>
                                    </div>
                                    <div class="text-xs text-slate-400">Run feast</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Analysis Results -->
                <div class="lg:col-span-7 space-y-6">
                    <!-- Strategic Intelligence Panel -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-green-400">üß† Strategic Intelligence</h3>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div class="bg-slate-800 p-4 rounded-lg text-center">
                                <div class="text-xs text-slate-400">Skill Difference</div>
                                <div id="skillDifference" class="text-2xl font-bold text-green-400">0</div>
                            </div>
                            <div class="bg-slate-800 p-4 rounded-lg text-center">
                                <div class="text-xs text-slate-400">Skill Factor</div>
                                <div id="skillFactor" class="text-2xl font-bold text-blue-400">1.00</div>
                            </div>
                            <div class="bg-slate-800 p-4 rounded-lg text-center">
                                <div class="text-xs text-slate-400">Pitch Factor</div>
                                <div id="pitchFactor" class="text-2xl font-bold text-yellow-400">1.00</div>
                            </div>
                            <div class="bg-slate-800 p-4 rounded-lg text-center">
                                <div class="text-xs text-slate-400">Phase Modifier</div>
                                <div id="phaseModifier" class="text-2xl font-bold text-purple-400">1.00</div>
                            </div>
                        </div>

                        <!-- Matchup Analysis -->
                        <div id="matchupAnalysis" class="bg-slate-800 p-4 rounded-lg mb-4">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-sm font-medium">Matchup Analysis:</span>
                                <span id="matchupResult" class="text-sm"></span>
                            </div>
                            <div id="matchupDetails" class="text-xs text-slate-400"></div>
                        </div>

                        <!-- Rating Guidelines -->
                        <div class="bg-slate-800 p-4 rounded-lg">
                            <h4 class="font-semibold mb-2">Elite Rating Guidelines</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-xs">
                                <div>Elite (90-95): Kohli, Smith, Bumrah</div>
                                <div>Excellent (85-90): International regulars</div>
                                <div>Good (75-85): Domestic stars</div>
                                <div>Average (65-75): Professionals</div>
                            </div>
                        </div>
                    </div>

                    <!-- Probability Breakdown -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-blue-400">üìä Probability Breakdown</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-slate-700">
                                        <th class="text-left py-2 text-slate-300">Outcome</th>
                                        <th class="text-right py-2 text-slate-300">Base %</th>
                                        <th class="text-right py-2 text-slate-300">Adjusted %</th>
                                        <th class="text-right py-2 text-slate-300">Final %</th>
                                    </tr>
                                </thead>
                                <tbody id="probabilityTable" class="text-slate-200">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Outcome Visualization -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-purple-400">üìà Outcome Probability</h3>
                        <div class="h-80">
                            <canvas id="outcomeChart"></canvas>
                        </div>
                    </div>

                    <!-- Performance Insights -->
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="cricket-heading text-xl mb-4 text-red-400">üí° Performance Insights</h3>
                        <div id="performanceInsights" class="space-y-3">
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        class CricketAnalyzer {
            constructor() {
                this.currentPhase = 'powerplay';
                this.currentPitch = 'Green';
                this.currentBowlingType = 'Fast';
                this.batsmanHand = 'right';
                this.bowlerHand = 'right';
                this.chart = null;

                this.pitchScoring = {
                    'Green': { '0': 0.40, '1': 0.34, '2': 0.06, '3': 0.01, '4': 0.06, '6': 0.02, 'W': 0.06, 'E': 0.05 },
                    'Dry': { '0': 0.34, '1': 0.33, '2': 0.09, '3': 0.04, '4': 0.06, '6': 0.02, 'W': 0.06, 'E': 0.06 },
                    'Hard': { '0': 0.28, '1': 0.31, '2': 0.11, '3': 0.06, '4': 0.09, '6': 0.04, 'W': 0.055, 'E': 0.055 },
                    'Flat': { '0': 0.26, '1': 0.30, '2': 0.11, '3': 0.04, '4': 0.15, '6': 0.05, 'W': 0.05, 'E': 0.04 },
                    'Dead': { '0': 0.15, '1': 0.29, '2': 0.12, '3': 0.02, '4': 0.22, '6': 0.14, 'W': 0.02, 'E': 0.04 }
                };

                this.phaseModifiers = {
                    'powerplay': { boundary: 1.1, wicket: 0.9 },
                    'middle': { boundary: 1.0, wicket: 1.0 },
                    'death': { boundary: 1.3, wicket: 1.2 }
                };

                this.bowlingMultipliers = {
                    'Green': { 'Fast': 1.4, 'Fast-medium': 1.2, 'Medium-fast': 1.15, 'default': 0.55 },
                    'Dry': { 'Leg spin': 1.4, 'Off spin': 1.3, 'Finger spin': 1.2, 'default': 0.6 },
                    'Hard': { 'Fast': 1.1, 'Fast-medium': 1.05, 'default': 0.9 },
                    'Flat': { 'default': 0.85 },
                    'Dead': { 'default': 0.6 }
                };

                this.initializeElements();
                this.bindEvents();
                this.initializeChart();
                this.updateAnalysis();
            }

            initializeElements() {
                this.batsmanRating = document.getElementById('batsmanRating');
                this.bowlerRating = document.getElementById('bowlerRating');
                this.fieldingRating = document.getElementById('fieldingRating');
                this.batsmanRatingValue = document.getElementById('batsmanRatingValue');
                this.bowlerRatingValue = document.getElementById('bowlerRatingValue');
                this.fieldingRatingValue = document.getElementById('fieldingRatingValue');
            }

            bindEvents() {
                // Rating sliders
                this.batsmanRating.addEventListener('input', () => this.updateAnalysis());
                this.bowlerRating.addEventListener('input', () => this.updateAnalysis());
                this.fieldingRating.addEventListener('input', () => this.updateAnalysis());

                // Phase tabs
                document.querySelectorAll('.phase-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        document.querySelectorAll('.phase-tab').forEach(t => t.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentPhase = e.target.dataset.phase;
                        this.updateAnalysis();
                    });
                });

                // Role cards
                document.querySelectorAll('.role-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        const type = e.currentTarget.dataset.type;
                        if (type === 'batsman') {
                            document.querySelectorAll('.role-card[data-type="batsman"]').forEach(c => c.classList.remove('active'));
                            e.currentTarget.classList.add('active');
                            this.updateRatingForRole(e.currentTarget.dataset.role, 'batsman');
                        } else if (e.currentTarget.dataset.bowling) {
                            document.querySelectorAll('.role-card[data-bowling]').forEach(c => c.classList.remove('active'));
                            e.currentTarget.classList.add('active');
                            this.currentBowlingType = e.currentTarget.dataset.bowling;
                            this.updateRatingForBowlingType(this.currentBowlingType);
                        }
                        this.updateAnalysis();
                    });
                });

                // Pitch cards
                document.querySelectorAll('.pitch-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        document.querySelectorAll('.pitch-card').forEach(c => c.classList.remove('active'));
                        e.currentTarget.classList.add('active');
                        this.currentPitch = e.currentTarget.dataset.pitch;
                        this.updateAnalysis();
                    });
                });

                // Hand buttons
                document.querySelectorAll('.hand-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const type = e.target.dataset.type;
                        const hand = e.target.dataset.hand;

                        document.querySelectorAll(`.hand-btn[data-type="${type}"]`).forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');

                        if (type === 'batsman') {
                            this.batsmanHand = hand;
                        } else {
                            this.bowlerHand = hand;
                        }
                        this.updateAnalysis();
                    });
                });
            }

            updateRatingForRole(role, type) {
                const ratings = {
                    'batsman': { batting: 90, bowling: 0 },
                    'batting-ar': { batting: 84, bowling: 65 },
                    'genuine-ar': { batting: 75, bowling: 75 },
                    'bowling-ar': { batting: 65, bowling: 84 }
                };

                if (type === 'batsman' && ratings[role]) {
                    this.batsmanRating.value = ratings[role].batting;
                }
            }

            updateRatingForBowlingType(bowlingType) {
                const bowlingRatings = {
                    'Fast': 90,
                    'Fast-medium': 87,
                    'Medium-fast': 84,
                    'Off spin': 88,
                    'Leg spin': 90,
                    'Finger spin': 86
                };

                if (bowlingRatings[bowlingType]) {
                    this.bowlerRating.value = bowlingRatings[bowlingType];
                }
            }

            getRatingCategory(rating) {
                if (rating >= 90) return { class: 'rating-elite', text: 'Elite' };
                if (rating >= 85) return { class: 'rating-excellent', text: 'Excellent' };
                if (rating >= 75) return { class: 'rating-good', text: 'Good' };
                if (rating >= 65) return { class: 'rating-average', text: 'Average' };
                return { class: 'rating-poor', text: 'Poor' };
            }

            updateAnalysis() {
                const batsmanRating = parseInt(this.batsmanRating.value);
                const bowlerRating = parseInt(this.bowlerRating.value);
                const fieldingRating = parseInt(this.fieldingRating.value);

                // Update display values
                this.batsmanRatingValue.textContent = batsmanRating;
                this.bowlerRatingValue.textContent = bowlerRating;
                this.fieldingRatingValue.textContent = fieldingRating;

                // Update rating badges
                const batsmanCategory = this.getRatingCategory(batsmanRating);
                const bowlerCategory = this.getRatingCategory(bowlerRating);

                const batsmanBadge = document.getElementById('batsmanRatingBadge');
                const bowlerBadge = document.getElementById('bowlerRatingBadge');

                batsmanBadge.className = `rating-badge ${batsmanCategory.class}`;
                batsmanBadge.textContent = batsmanCategory.text;
                bowlerBadge.className = `rating-badge ${bowlerCategory.class}`;
                bowlerBadge.textContent = bowlerCategory.text;

                // Calculate factors
                const skillDifference = batsmanRating - bowlerRating;
                const skillFactor = 0.4 * (batsmanRating / (batsmanRating + bowlerRating)) + 0.6;
                const pitchFactor = this.getPitchFactor();
                const phaseModifier = this.phaseModifiers[this.currentPhase];

                // Update display
                document.getElementById('skillDifference').textContent = skillDifference > 0 ? `+${skillDifference}` : skillDifference;
                document.getElementById('skillFactor').textContent = skillFactor.toFixed(2);
                document.getElementById('pitchFactor').textContent = pitchFactor.toFixed(2);
                document.getElementById('phaseModifier').textContent = phaseModifier.boundary.toFixed(2);

                // Matchup analysis
                this.updateMatchupAnalysis();

                // Calculate probabilities
                const probabilities = this.calculateProbabilities(batsmanRating, bowlerRating, fieldingRating);
                this.updateProbabilityTable(probabilities);
                this.updateChart(probabilities.final);
                this.updateInsights(batsmanRating, bowlerRating, skillDifference);
            }

            getPitchFactor() {
                const factors = { 'Green': 0.70, 'Dry': 0.70, 'Hard': 1.10, 'Flat': 1.20, 'Dead': 1.30 };
                return factors[this.currentPitch] || 1.0;
            }

            updateMatchupAnalysis() {
                const matchupResult = document.getElementById('matchupResult');
                const matchupDetails = document.getElementById('matchupDetails');

                let advantage = 'Neutral';
                let details = '';
                let isSpecial = false;

                // Left arm vs right hand matchup
                if (this.bowlerHand === 'left' && this.batsmanHand === 'right' && this.currentPitch === 'Green') {
                    advantage = 'Bowler Advantage';
                    details = 'Left-arm pace vs right-hand on green pitch (+20% wicket chance)';
                    isSpecial = true;
                }

                // Bowling type vs pitch matchups
                const bowlingAdvantages = {
                    'Green': ['Fast', 'Fast-medium'],
                    'Dry': ['Leg spin', 'Off spin', 'Finger spin']
                };

                if (bowlingAdvantages[this.currentPitch]?.includes(this.currentBowlingType)) {
                    advantage = 'Bowler Advantage';
                    details = `${this.currentBowlingType} bowling on ${this.currentPitch} pitch (favorable conditions)`;
                    isSpecial = true;
                }

                if (this.currentPitch === 'Flat' || this.currentPitch === 'Dead') {
                    advantage = 'Batsman Advantage';
                    details = `${this.currentPitch} pitch favors batting (high scoring expected)`;
                }

                matchupResult.textContent = advantage;
                matchupResult.className = `text-sm font-semibold ${isSpecial ? 'matchup-indicator' : ''}`;

                if (advantage === 'Bowler Advantage') {
                    matchupResult.classList.add('text-red-400');
                } else if (advantage === 'Batsman Advantage') {
                    matchupResult.classList.add('text-green-400');
                } else {
                    matchupResult.classList.add('text-yellow-400');
                }

                matchupDetails.textContent = details;
            }

            calculateProbabilities(batsmanRating, bowlerRating, fieldingRating) {
                const base = this.pitchScoring[this.currentPitch];
                const adjusted = {};
                const final = {};

                const outcomes = ['0', '1', '2', '3', '4', '6', 'W', 'E'];
                let totalAdjusted = 0;

                outcomes.forEach(outcome => {
                    const baseProb = base[outcome] || 0;
                    let adjustedProb = baseProb;

                    if (outcome === 'W') {
                        // Wicket calculation
                        const skillFrac = 0.4 * (bowlerRating / (batsmanRating + bowlerRating)) * (fieldingRating / 100.0) + 0.6;
                        const bowlingMultiplier = this.getBowlingMultiplier();
                        adjustedProb = baseProb * skillFrac * bowlingMultiplier;

                        // Left vs right matchup bonus
                        if (this.bowlerHand === 'left' && this.batsmanHand === 'right' && this.currentPitch === 'Green') {
                            adjustedProb *= 1.2;
                        }

                        // Phase modifier
                        adjustedProb *= this.phaseModifiers[this.currentPhase].wicket;
                    } else if (outcome === 'E') {
                        // Extras depend on bowler error
                        adjustedProb = baseProb * ((100 - bowlerRating) / 100.0);
                    } else {
                        // Runs calculation
                        const skillFrac = 0.4 * (batsmanRating / (batsmanRating + bowlerRating)) + 0.6 * this.getPitchFactor();
                        adjustedProb = baseProb * skillFrac;

                        // Apply phase modifiers for boundaries
                        if (outcome === '4' || outcome === '6') {
                            adjustedProb *= this.phaseModifiers[this.currentPhase].boundary;
                        }
                    }

                    adjusted[outcome] = Math.max(0, adjustedProb);
                    totalAdjusted += adjusted[outcome];
                });

                // Normalize to get final probabilities
                outcomes.forEach(outcome => {
                    final[outcome] = (adjusted[outcome] / totalAdjusted) * 100;
                });

                return { base, adjusted, final };
            }

            getBowlingMultiplier() {
                const pitchMultipliers = this.bowlingMultipliers[this.currentPitch];
                return pitchMultipliers[this.currentBowlingType] || pitchMultipliers.default || 1.0;
            }

            updateProbabilityTable(probabilities) {
                const tableBody = document.getElementById('probabilityTable');
                const outcomes = [
                    { key: '0', label: 'Dot Ball' },
                    { key: '1', label: 'Single' },
                    { key: '2', label: 'Double' },
                    { key: '3', label: 'Triple' },
                    { key: '4', label: 'Four' },
                    { key: '6', label: 'Six' },
                    { key: 'W', label: 'Wicket' },
                    { key: 'E', label: 'Extra' }
                ];

                tableBody.innerHTML = '';
                outcomes.forEach(outcome => {
                    const row = document.createElement('tr');
                    row.className = 'border-b border-slate-700';
                    row.innerHTML = `
                        <td class="py-2 font-medium">${outcome.label}</td>
                        <td class="py-2 text-right">${(probabilities.base[outcome.key] * 100).toFixed(1)}%</td>
                        <td class="py-2 text-right">${(probabilities.adjusted[outcome.key] / probabilities.adjusted['0'] * probabilities.base['0'] * 100).toFixed(1)}%</td>
                        <td class="py-2 text-right font-bold text-green-400">${probabilities.final[outcome.key].toFixed(1)}%</td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            initializeChart() {
                const ctx = document.getElementById('outcomeChart').getContext('2d');
                this.chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Dot', 'Single', 'Double', 'Triple', 'Four', 'Six', 'Wicket', 'Extra'],
                        datasets: [{
                            label: 'Probability (%)',
                            data: [],
                            backgroundColor: [
                                'rgba(75, 85, 99, 0.8)',   // Dot - gray
                                'rgba(59, 130, 246, 0.8)',  // Single - blue
                                'rgba(59, 130, 246, 0.6)',  // Double - blue
                                'rgba(59, 130, 246, 0.4)',  // Triple - blue
                                'rgba(16, 185, 129, 0.8)',  // Four - green
                                'rgba(168, 85, 247, 0.8)',  // Six - purple
                                'rgba(239, 68, 68, 0.8)',   // Wicket - red
                                'rgba(245, 158, 11, 0.8)'   // Extra - yellow
                            ],
                            borderColor: [
                                'rgba(75, 85, 99, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)',
                                'rgba(168, 85, 247, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(245, 158, 11, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                                titleColor: '#e2e8f0',
                                bodyColor: '#e2e8f0',
                                borderColor: '#334155',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(51, 65, 85, 0.3)' },
                                ticks: { color: '#94a3b8' },
                                title: {
                                    display: true,
                                    text: 'Probability (%)',
                                    color: '#94a3b8'
                                }
                            },
                            x: {
                                grid: { color: 'rgba(51, 65, 85, 0.3)' },
                                ticks: { color: '#94a3b8' }
                            }
                        }
                    }
                });
            }

            updateChart(finalProbs) {
                const data = ['0', '1', '2', '3', '4', '6', 'W', 'E'].map(key => finalProbs[key]);
                this.chart.data.datasets[0].data = data;
                this.chart.update('none');
            }

            updateInsights(batsmanRating, bowlerRating, skillDifference) {
                const insights = [];

                if (Math.abs(skillDifference) >= 20) {
                    if (skillDifference > 0) {
                        insights.push('üî• Significant batting advantage - expect aggressive strokeplay');
                    } else {
                        insights.push('‚ö° Major bowling threat - wickets likely');
                    }
                }

                if (this.currentPhase === 'death') {
                    insights.push('üíÄ Death overs: Boundaries and wickets both increase significantly');
                }

                if (this.currentPitch === 'Green' && this.currentBowlingType.includes('Fast')) {
                    insights.push('üå± Perfect conditions for pace bowling - seam movement expected');
                }

                if (this.currentPitch === 'Dry' && this.currentBowlingType.includes('spin')) {
                    insights.push('üå™Ô∏è Spin-friendly conditions - turn and bounce likely');
                }

                if (batsmanRating >= 90 && this.currentPhase === 'powerplay') {
                    insights.push('‚≠ê Elite batsman in powerplay - boundary scoring probable');
                }

                const insightsContainer = document.getElementById('performanceInsights');
                insightsContainer.innerHTML = insights.map(insight =>
                    `<div class="bg-slate-800 p-3 rounded-lg text-sm">${insight}</div>`
                ).join('');
            }
        }

        // Initialize the analyzer when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new CricketAnalyzer();

            // Theme Toggle Functionality
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const root = document.documentElement;

            // Initialize theme from localStorage (default to dark for this page)
            const savedTheme = localStorage.getItem('theme') || 'dark';
            root.setAttribute('data-theme', savedTheme);
            themeIcon.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

            themeToggle.addEventListener('click', () => {
                const currentTheme = root.getAttribute('data-theme') || 'dark';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                root.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                themeIcon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            });
        });
    </script>
</body>

</html>